-- Example SQL report with variable substitution
-- config: materialized=table
-- depends_on: source_table

SELECT
    $start_date as report_start_date,
    $end_date as report_end_date,
    customer_id,
    COUNT(*) as order_count,
    SUM(amount) as total_amount,
    AVG(amount) as avg_amount
FROM source_table
WHERE 
    order_date BETWEEN $start_date AND $end_date
    AND status = 'completed'
GROUP BY customer_id

